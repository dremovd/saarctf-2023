from pwn import *

r = remote('144.76.26.107', 30000, ssl=True)

"""

Task format:
1 | <task_action_id> | task name | task description | steps to reproduce | epic | sprint | hours estimated

Holiday format:
2 | <leave action id> | start date | end date | reason for holiday | holiday destination | emergency phone number

- Log in as any user
- Create holiday with user injection
- Using this injected (known password), recover task with flag

"""

def login(first_name=b'trager', last_name=b'trager', password=b'trager'):
    r.recv()
    r.sendline(b'Login')
    r.sendline(first_name)
    r.sendline(last_name)
    r.sendline(password)
    r.recvline()
    r.recvline()
    r.recvline()
    r.recvline()
    r.recvline()
    r.recvline()
    r.recvline()
    r.recvline()

def get_employee_register():
    r.recvline()
    r.recvline()
    r.recvline()
    r.recvline()
    r.recvline()
    r.recvline()
    r.sendline(b"View the employee register")
    r.recvline()
    employees = {}
    while True:
        employee = r.recvline().strip().decode()
        if 'End of employee list.' not in employee:
            employee_id, _, first_name, last_name = employee.split('|')
            first_name = first_name.strip()
            last_name = last_name.strip()
            employee_id = employee_id.strip()
            employees[f'{first_name} {last_name}'] = employee_id
        else:
            break
    return employees


if __name__ == '__main__':
    # login()
    login(first_name=b'test', last_name=b'test', password=b'test')
    r.interactive()

    # r.interactive()
